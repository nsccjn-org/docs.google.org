"use strict";(self.webpackChunkawesometic_docs=self.webpackChunkawesometic_docs||[]).push([[4131],{28453:(n,e,i)=>{i.d(e,{R:()=>l,x:()=>a});var t=i(96540);const r={},s=t.createContext(r);function l(n){const e=t.useContext(s);return t.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function a(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(r):n.components||r:l(n.components),t.createElement(s.Provider,{value:e},n.children)}},92531:(n,e,i)=>{i.r(e),i.d(e,{assets:()=>o,contentTitle:()=>a,default:()=>d,frontMatter:()=>l,metadata:()=>t,toc:()=>u});const t=JSON.parse('{"id":"software/3.5_env/singularity","title":"singularityce","description":"\u5bb9\u5668\u6280\u672f\u662f\u4e00\u79cd\u4ee5\u5e94\u7528\u8f6f\u4ef6\u4e3a\u4e2d\u5fc3\u7684\u865a\u62df\u5316\u6280\u672f\u3002\u4ee5\u5e94\u7528\u8f6f\u4ef6\u4e3a\u5355\u5143\uff0c\u5c06\u8f6f\u4ef6\u53ca\u6240\u6709\u7684\u4f9d\u8d56\u6253\u5305\u6210\u5bb9\u5668\u955c\u50cf\uff0c\u6253\u5305\u540e\u7684\u5bb9\u5668\u955c\u50cf\u53ef\u76f4\u63a5\u62f7\u8d1d\u5230\u4e0d\u540c\u7684Linux\u4e3b\u673a\u4e0a\u8fd0\u884c\u3002\u901a\u8fc7\u5bb9\u5668\u6280\u672f\uff0c\u53ef\u4ee5\u5f88\u597d\u7684\u89e3\u51b3\u5b89\u88c5\u8f6f\u4ef6\u65f6\uff0c\u4f9d\u8d56\u5e93\u7684\u5b89\u88c5\u95ee\u9898\u3001\u8f6f\u4ef6\u73af\u5883\u7684\u9694\u79bb\u4ee5\u53ca\u8f6f\u4ef6\u73af\u5883\u7684\u79fb\u690d\u95ee\u9898\u3002","source":"@site/hpc/3_software/3.5_env/singularity.md","sourceDirName":"3_software/3.5_env","slug":"/software/3.5_env/singularity","permalink":"/hpc/software/3.5_env/singularity","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":9,"frontMatter":{"sidebar_position":9},"sidebar":"hpc","previous":{"title":"shell","permalink":"/hpc/software/3.5_env/shell"},"next":{"title":"vim","permalink":"/hpc/software/3.5_env/vim"}}');var r=i(74848),s=i(28453);const l={sidebar_position:9},a="singularityce",o={},u=[{value:"\u5bb9\u5668\u6280\u672f\u662f\u4e00\u79cd\u4ee5\u5e94\u7528\u8f6f\u4ef6\u4e3a\u4e2d\u5fc3\u7684\u865a\u62df\u5316\u6280\u672f\u3002\u4ee5\u5e94\u7528\u8f6f\u4ef6\u4e3a\u5355\u5143\uff0c\u5c06\u8f6f\u4ef6\u53ca\u6240\u6709\u7684\u4f9d\u8d56\u6253\u5305\u6210\u5bb9\u5668\u955c\u50cf\uff0c\u6253\u5305\u540e\u7684\u5bb9\u5668\u955c\u50cf\u53ef\u76f4\u63a5\u62f7\u8d1d\u5230\u4e0d\u540c\u7684Linux\u4e3b\u673a\u4e0a\u8fd0\u884c\u3002\u901a\u8fc7\u5bb9\u5668\u6280\u672f\uff0c\u53ef\u4ee5\u5f88\u597d\u7684\u89e3\u51b3\u5b89\u88c5\u8f6f\u4ef6\u65f6\uff0c\u4f9d\u8d56\u5e93\u7684\u5b89\u88c5\u95ee\u9898\u3001\u8f6f\u4ef6\u73af\u5883\u7684\u9694\u79bb\u4ee5\u53ca\u8f6f\u4ef6\u73af\u5883\u7684\u79fb\u690d\u95ee\u9898\u3002",id:"\u5bb9\u5668\u6280\u672f\u662f\u4e00\u79cd\u4ee5\u5e94\u7528\u8f6f\u4ef6\u4e3a\u4e2d\u5fc3\u7684\u865a\u62df\u5316\u6280\u672f\u4ee5\u5e94\u7528\u8f6f\u4ef6\u4e3a\u5355\u5143\u5c06\u8f6f\u4ef6\u53ca\u6240\u6709\u7684\u4f9d\u8d56\u6253\u5305\u6210\u5bb9\u5668\u955c\u50cf\u6253\u5305\u540e\u7684\u5bb9\u5668\u955c\u50cf\u53ef\u76f4\u63a5\u62f7\u8d1d\u5230\u4e0d\u540c\u7684linux\u4e3b\u673a\u4e0a\u8fd0\u884c\u901a\u8fc7\u5bb9\u5668\u6280\u672f\u53ef\u4ee5\u5f88\u597d\u7684\u89e3\u51b3\u5b89\u88c5\u8f6f\u4ef6\u65f6\u4f9d\u8d56\u5e93\u7684\u5b89\u88c5\u95ee\u9898\u8f6f\u4ef6\u73af\u5883\u7684\u9694\u79bb\u4ee5\u53ca\u8f6f\u4ef6\u73af\u5883\u7684\u79fb\u690d\u95ee\u9898",level:6},{value:"Singularity\u4e3a\u52b3\u4f26\u65af\u4f2f\u514b\u5229\u56fd\u5bb6\u5b9e\u9a8c\u5ba4\u5f00\u53d1\u4e13\u95e8\u7528\u4e8e\u9ad8\u6027\u80fd\u8ba1\u7b97\u573a\u666f\u7684\u5bb9\u5668\u6280\u672f\uff0cSingularity\u5b8c\u5168\u57fa\u4e8e\u53ef\u79fb\u690d\u6027\u8fdb\u884c\u865a\u62df\u5316\uff0c\u66f4\u52a0\u8f7b\u91cf\u7ea7\uff0c\u90e8\u7f72\u66f4\u5feb\uff0cSingularity\u76ee\u524d\u88ab\u5e7f\u6cdb\u5730\u5404\u9ad8\u6027\u80fd\u8ba1\u7b97\u4e2d\u5fc3\u3002",id:"singularity\u4e3a\u52b3\u4f26\u65af\u4f2f\u514b\u5229\u56fd\u5bb6\u5b9e\u9a8c\u5ba4\u5f00\u53d1\u4e13\u95e8\u7528\u4e8e\u9ad8\u6027\u80fd\u8ba1\u7b97\u573a\u666f\u7684\u5bb9\u5668\u6280\u672fsingularity\u5b8c\u5168\u57fa\u4e8e\u53ef\u79fb\u690d\u6027\u8fdb\u884c\u865a\u62df\u5316\u66f4\u52a0\u8f7b\u91cf\u7ea7\u90e8\u7f72\u66f4\u5febsingularity\u76ee\u524d\u88ab\u5e7f\u6cdb\u5730\u5404\u9ad8\u6027\u80fd\u8ba1\u7b97\u4e2d\u5fc3",level:6},{value:"Singularity\u5bb9\u5668\u6280\u672f\u5728\u529f\u80fd\u4e0a\u7c7b\u4f3c\u4e8eDocker\uff0c\u4f7f\u7528\u4e0a\u4e0eDocker\u7565\u6709\u4e0d\u540c\u3002Docker\u7528\u6237\u53ef\u4ee5\u8f7b\u677e\u4e0a\u624b\u4f7f\u7528\u3002\u7531\u4e8eDocker \u5728\u5b89\u5168\u3001\u6743\u9650\u3001\u9ad8\u901f\u7f51\u7edc\u652f\u6301\u3001MPI\u5e76\u884c\u652f\u6301\u7b49\u5404\u65b9\u9762\u5929\u751f\u4e14\u65e0\u6cd5\u4fee\u8865\u7684\u7f3a\u9677\uff0c\u5bfc\u81f4 Docker \u5728\u8d85\u7b97\u4e0a\u4e0d\u9002\u5408\u4f7f\u7528\uff0c\u4e3a\u4e86\u9002\u5e94\u8d85\u7b97\u7279\u6709\u7684\u5e73\u53f0\u73af\u5883\uff0c\u51fa\u73b0\u4e86\u4e00\u4e9b\u4e13\u95e8\u4e3a\u8d85\u7b97\u73af\u5883\u5f00\u53d1\u7684\u5bb9\u5668\u8f6f\u4ef6\uff0c\u5728\u76ee\u524d\u9002\u5408\u4e8e\u8d85\u7b97\u7684\u5bb9\u5668\u8f6f\u4ef6\u91cc\uff0cSingularity \u7684\u517c\u5bb9\u6027\u6700\u597d\uff0c\u5bf9\u8d85\u7b97\u7279\u6027\u652f\u6301\u6700\u5b8c\u6574\uff0c\u8fd0\u884c\u6027\u80fd\u4e5f\u662f\u6700\u597d\u7684\u3002",id:"singularity\u5bb9\u5668\u6280\u672f\u5728\u529f\u80fd\u4e0a\u7c7b\u4f3c\u4e8edocker\u4f7f\u7528\u4e0a\u4e0edocker\u7565\u6709\u4e0d\u540cdocker\u7528\u6237\u53ef\u4ee5\u8f7b\u677e\u4e0a\u624b\u4f7f\u7528\u7531\u4e8edocker-\u5728\u5b89\u5168\u6743\u9650\u9ad8\u901f\u7f51\u7edc\u652f\u6301mpi\u5e76\u884c\u652f\u6301\u7b49\u5404\u65b9\u9762\u5929\u751f\u4e14\u65e0\u6cd5\u4fee\u8865\u7684\u7f3a\u9677\u5bfc\u81f4-docker-\u5728\u8d85\u7b97\u4e0a\u4e0d\u9002\u5408\u4f7f\u7528\u4e3a\u4e86\u9002\u5e94\u8d85\u7b97\u7279\u6709\u7684\u5e73\u53f0\u73af\u5883\u51fa\u73b0\u4e86\u4e00\u4e9b\u4e13\u95e8\u4e3a\u8d85\u7b97\u73af\u5883\u5f00\u53d1\u7684\u5bb9\u5668\u8f6f\u4ef6\u5728\u76ee\u524d\u9002\u5408\u4e8e\u8d85\u7b97\u7684\u5bb9\u5668\u8f6f\u4ef6\u91ccsingularity-\u7684\u517c\u5bb9\u6027\u6700\u597d\u5bf9\u8d85\u7b97\u7279\u6027\u652f\u6301\u6700\u5b8c\u6574\u8fd0\u884c\u6027\u80fd\u4e5f\u662f\u6700\u597d\u7684",level:6},{value:"\u4e00\u3001\u811a\u672c\u6a21\u677f",id:"\u4e00\u811a\u672c\u6a21\u677f",level:4},{value:"\u4e8c\u3001\u672c\u5730\u5b89\u88c5singulartyce",id:"\u4e8c\u672c\u5730\u5b89\u88c5singulartyce",level:3},{value:"\u4e09\u3001\u6784\u5efa\u5bb9\u5668",id:"\u4e09\u6784\u5efa\u5bb9\u5668",level:3},{value:"\u901a\u8fc7\u5df2\u6709\u955c\u50cf\u6784\u5efa",id:"\u901a\u8fc7\u5df2\u6709\u955c\u50cf\u6784\u5efa",level:4},{value:"Definition \u6587\u4ef6-.def",id:"definition-\u6587\u4ef6-def",level:4},{value:"\u56db\u3001singularity \u5e38\u7528\u547d\u4ee4",id:"\u56dbsingularity-\u5e38\u7528\u547d\u4ee4",level:3},{value:"\u4e94\u3001\u642d\u5efa\u8f6f\u4ef6\u73af\u5883",id:"\u4e94\u642d\u5efa\u8f6f\u4ef6\u73af\u5883",level:3},{value:"\u516d\u3001\u96c6\u7fa4\u4f7f\u7528singularity",id:"\u516d\u96c6\u7fa4\u4f7f\u7528singularity",level:3}];function c(n){const e={code:"code",h1:"h1",h3:"h3",h4:"h4",h6:"h6",header:"header",hr:"hr",p:"p",pre:"pre",...(0,s.R)(),...n.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e.header,{children:(0,r.jsx)(e.h1,{id:"singularityce",children:"singularityce"})}),"\n",(0,r.jsx)(e.h6,{id:"\u5bb9\u5668\u6280\u672f\u662f\u4e00\u79cd\u4ee5\u5e94\u7528\u8f6f\u4ef6\u4e3a\u4e2d\u5fc3\u7684\u865a\u62df\u5316\u6280\u672f\u4ee5\u5e94\u7528\u8f6f\u4ef6\u4e3a\u5355\u5143\u5c06\u8f6f\u4ef6\u53ca\u6240\u6709\u7684\u4f9d\u8d56\u6253\u5305\u6210\u5bb9\u5668\u955c\u50cf\u6253\u5305\u540e\u7684\u5bb9\u5668\u955c\u50cf\u53ef\u76f4\u63a5\u62f7\u8d1d\u5230\u4e0d\u540c\u7684linux\u4e3b\u673a\u4e0a\u8fd0\u884c\u901a\u8fc7\u5bb9\u5668\u6280\u672f\u53ef\u4ee5\u5f88\u597d\u7684\u89e3\u51b3\u5b89\u88c5\u8f6f\u4ef6\u65f6\u4f9d\u8d56\u5e93\u7684\u5b89\u88c5\u95ee\u9898\u8f6f\u4ef6\u73af\u5883\u7684\u9694\u79bb\u4ee5\u53ca\u8f6f\u4ef6\u73af\u5883\u7684\u79fb\u690d\u95ee\u9898",children:"\u5bb9\u5668\u6280\u672f\u662f\u4e00\u79cd\u4ee5\u5e94\u7528\u8f6f\u4ef6\u4e3a\u4e2d\u5fc3\u7684\u865a\u62df\u5316\u6280\u672f\u3002\u4ee5\u5e94\u7528\u8f6f\u4ef6\u4e3a\u5355\u5143\uff0c\u5c06\u8f6f\u4ef6\u53ca\u6240\u6709\u7684\u4f9d\u8d56\u6253\u5305\u6210\u5bb9\u5668\u955c\u50cf\uff0c\u6253\u5305\u540e\u7684\u5bb9\u5668\u955c\u50cf\u53ef\u76f4\u63a5\u62f7\u8d1d\u5230\u4e0d\u540c\u7684Linux\u4e3b\u673a\u4e0a\u8fd0\u884c\u3002\u901a\u8fc7\u5bb9\u5668\u6280\u672f\uff0c\u53ef\u4ee5\u5f88\u597d\u7684\u89e3\u51b3\u5b89\u88c5\u8f6f\u4ef6\u65f6\uff0c\u4f9d\u8d56\u5e93\u7684\u5b89\u88c5\u95ee\u9898\u3001\u8f6f\u4ef6\u73af\u5883\u7684\u9694\u79bb\u4ee5\u53ca\u8f6f\u4ef6\u73af\u5883\u7684\u79fb\u690d\u95ee\u9898\u3002"}),"\n",(0,r.jsx)(e.h6,{id:"singularity\u4e3a\u52b3\u4f26\u65af\u4f2f\u514b\u5229\u56fd\u5bb6\u5b9e\u9a8c\u5ba4\u5f00\u53d1\u4e13\u95e8\u7528\u4e8e\u9ad8\u6027\u80fd\u8ba1\u7b97\u573a\u666f\u7684\u5bb9\u5668\u6280\u672fsingularity\u5b8c\u5168\u57fa\u4e8e\u53ef\u79fb\u690d\u6027\u8fdb\u884c\u865a\u62df\u5316\u66f4\u52a0\u8f7b\u91cf\u7ea7\u90e8\u7f72\u66f4\u5febsingularity\u76ee\u524d\u88ab\u5e7f\u6cdb\u5730\u5404\u9ad8\u6027\u80fd\u8ba1\u7b97\u4e2d\u5fc3",children:"Singularity\u4e3a\u52b3\u4f26\u65af\u4f2f\u514b\u5229\u56fd\u5bb6\u5b9e\u9a8c\u5ba4\u5f00\u53d1\u4e13\u95e8\u7528\u4e8e\u9ad8\u6027\u80fd\u8ba1\u7b97\u573a\u666f\u7684\u5bb9\u5668\u6280\u672f\uff0cSingularity\u5b8c\u5168\u57fa\u4e8e\u53ef\u79fb\u690d\u6027\u8fdb\u884c\u865a\u62df\u5316\uff0c\u66f4\u52a0\u8f7b\u91cf\u7ea7\uff0c\u90e8\u7f72\u66f4\u5feb\uff0cSingularity\u76ee\u524d\u88ab\u5e7f\u6cdb\u5730\u5404\u9ad8\u6027\u80fd\u8ba1\u7b97\u4e2d\u5fc3\u3002"}),"\n",(0,r.jsx)(e.h6,{id:"singularity\u5bb9\u5668\u6280\u672f\u5728\u529f\u80fd\u4e0a\u7c7b\u4f3c\u4e8edocker\u4f7f\u7528\u4e0a\u4e0edocker\u7565\u6709\u4e0d\u540cdocker\u7528\u6237\u53ef\u4ee5\u8f7b\u677e\u4e0a\u624b\u4f7f\u7528\u7531\u4e8edocker-\u5728\u5b89\u5168\u6743\u9650\u9ad8\u901f\u7f51\u7edc\u652f\u6301mpi\u5e76\u884c\u652f\u6301\u7b49\u5404\u65b9\u9762\u5929\u751f\u4e14\u65e0\u6cd5\u4fee\u8865\u7684\u7f3a\u9677\u5bfc\u81f4-docker-\u5728\u8d85\u7b97\u4e0a\u4e0d\u9002\u5408\u4f7f\u7528\u4e3a\u4e86\u9002\u5e94\u8d85\u7b97\u7279\u6709\u7684\u5e73\u53f0\u73af\u5883\u51fa\u73b0\u4e86\u4e00\u4e9b\u4e13\u95e8\u4e3a\u8d85\u7b97\u73af\u5883\u5f00\u53d1\u7684\u5bb9\u5668\u8f6f\u4ef6\u5728\u76ee\u524d\u9002\u5408\u4e8e\u8d85\u7b97\u7684\u5bb9\u5668\u8f6f\u4ef6\u91ccsingularity-\u7684\u517c\u5bb9\u6027\u6700\u597d\u5bf9\u8d85\u7b97\u7279\u6027\u652f\u6301\u6700\u5b8c\u6574\u8fd0\u884c\u6027\u80fd\u4e5f\u662f\u6700\u597d\u7684",children:"Singularity\u5bb9\u5668\u6280\u672f\u5728\u529f\u80fd\u4e0a\u7c7b\u4f3c\u4e8eDocker\uff0c\u4f7f\u7528\u4e0a\u4e0eDocker\u7565\u6709\u4e0d\u540c\u3002Docker\u7528\u6237\u53ef\u4ee5\u8f7b\u677e\u4e0a\u624b\u4f7f\u7528\u3002\u7531\u4e8eDocker \u5728\u5b89\u5168\u3001\u6743\u9650\u3001\u9ad8\u901f\u7f51\u7edc\u652f\u6301\u3001MPI\u5e76\u884c\u652f\u6301\u7b49\u5404\u65b9\u9762\u5929\u751f\u4e14\u65e0\u6cd5\u4fee\u8865\u7684\u7f3a\u9677\uff0c\u5bfc\u81f4 Docker \u5728\u8d85\u7b97\u4e0a\u4e0d\u9002\u5408\u4f7f\u7528\uff0c\u4e3a\u4e86\u9002\u5e94\u8d85\u7b97\u7279\u6709\u7684\u5e73\u53f0\u73af\u5883\uff0c\u51fa\u73b0\u4e86\u4e00\u4e9b\u4e13\u95e8\u4e3a\u8d85\u7b97\u73af\u5883\u5f00\u53d1\u7684\u5bb9\u5668\u8f6f\u4ef6\uff0c\u5728\u76ee\u524d\u9002\u5408\u4e8e\u8d85\u7b97\u7684\u5bb9\u5668\u8f6f\u4ef6\u91cc\uff0cSingularity \u7684\u517c\u5bb9\u6027\u6700\u597d\uff0c\u5bf9\u8d85\u7b97\u7279\u6027\u652f\u6301\u6700\u5b8c\u6574\uff0c\u8fd0\u884c\u6027\u80fd\u4e5f\u662f\u6700\u597d\u7684\u3002"}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h4,{id:"\u4e00\u811a\u672c\u6a21\u677f",children:"\u4e00\u3001\u811a\u672c\u6a21\u677f"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:" #!/bin/bash\n #SBATCH --nodes=1                   # \u8282\u70b9\u6570\u91cf\n #SBATCH --ntasks-per-node=56        # \u6bcf\u4e2a\u8282\u70b9\u6838\u5fc3\u6570\u91cf\n #SBATCH --ntasks=56                 # \u603b\u6838\u5fc3\u6570\n #SBATCH --partition=g1_share        # \u961f\u5217\u5206\u533a\u4e14\u5fc5\u987b\u6307\u5b9a\u6b63\u786e\u5206\u533a\n #SBATCH --job-name=singularity             # \u4f5c\u4e1a\u540d\u79f0\n #SBATCH --output=sin.%j.out        # \u6b63\u5e38\u65e5\u5fd7\u8f93\u51fa (%j \u53c2\u6570\u503c\u4e3a jobId)\n #SBATCH --error=sin.%j.err         # \u9519\u8bef\u65e5\u5fd7\u8f93\u51fa (%j \u53c2\u6570\u503c\u4e3a jobId)\n\n ##############################################\n #          Software Envrironment             #\n ##############################################\n unset I_MPI_PMI_LIBRARY                        # \u53d6\u6d88\u9ed8\u8ba4mpi\u5e93\uff0c\u4f7f\u7528intel\u81ea\u5e26\n export I_MPI_JOB_RESPECT_PROCESS_PLACEMENT=0   # intel \u591a\u8282\u70b9\u4f5c\u4e1a\u6240\u9700\u4fee\u6539\u53c2\u6570\n module load singularity/3.10.0        # intel \u73af\u5883\u52a0\u8f7d\n\n ##############################################\n #               Run job                      #\n ##############################################\n singularity exec --bind /home/cloudam/singularity/lammps:/home/cloudam/singularity/lammps  lammps.sif mpirun  lmp_mpi -in M-1.in\n ###--bind \u53c2\u6570 \u540c -B \u6620\u5c04\u76ee\u5f55 \u4e3b\u673a\u76ee\u5f55\uff1a\u5bb9\u5668\u76ee\u5f55 \n"})}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h3,{id:"\u4e8c\u672c\u5730\u5b89\u88c5singulartyce",children:"\u4e8c\u3001\u672c\u5730\u5b89\u88c5singulartyce"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"# \u5b89\u88c5\u4f9d\u8d56\nyum install -y gcc libuuid-devel squashfs-tools openssl-devel make\n\n# \u5b89\u88c5go\nexport VERSION=1.17.2 OS=linux ARCH=amd64   \nwget https://dl.google.com/go/go$VERSION.$OS-$ARCH.tar.gz \ntar -C /usr/local -xzvf go$VERSION.$OS-$ARCH.tar.gz\nrm -f go$VERSION.$OS-$ARCH.tar.gz \necho 'export PATH=/usr/local/go/bin:$PATH' >> /etc/profile\nsource /etc/profile\n\n# \u5b89\u88c5singularity\nexport VERSION=3.9.2\nwget https://github.com/sylabs/singularity/releases/download/v${VERSION}/singularity-ce-${VERSION}.tar.gz \ntar -xzf singularity-ce-${VERSION}.tar.gz\ncd singularity-ce-${VERSION}\n./mconfig --prefix=/opt/singularity/${VERSION}\ncd builddir/\nmake && make install\necho \"export PATH=/opt/singularity/${VERSION}/bin:\\$PATH\" >> /etc/profile\n"})}),"\n",(0,r.jsx)(e.h3,{id:"\u4e09\u6784\u5efa\u5bb9\u5668",children:"\u4e09\u3001\u6784\u5efa\u5bb9\u5668"}),"\n",(0,r.jsx)(e.h4,{id:"\u901a\u8fc7\u5df2\u6709\u955c\u50cf\u6784\u5efa",children:"\u901a\u8fc7\u5df2\u6709\u955c\u50cf\u6784\u5efa"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"singularity build --sandbox ansys2022R1 docker://centos:7.6.1810\n #build \u6784\u5efa\u547d\u4ee4\uff1b--sandbox \u53ef\u5199\u5bb9\u5668\u955c\u50cf\uff0c\u4e0d\u52a0\u8fd9\u4e2a\u540e\u7f00 \u9ed8\u8ba4\u521b\u5efasif\u53ea\u8bfb\u6a21\u5f0f\u955c\u50cf\uff1b molspin \u6784\u5efa\u5bb9\u5668\u540d \n#docker:// ubuntu:18.04  \n\n##\u53ef\u4ee5\u5728 docker \u955c\u50cf\u5e93\u67e5\u627e\u5bf9\u5e94\u7248\u672c\u955c\u50cf   https://hub.docker.com/search?image_filter=official&q=\n"})}),"\n",(0,r.jsx)(e.h4,{id:"definition-\u6587\u4ef6-def",children:"Definition \u6587\u4ef6-.def"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:'#Definition \u5bb9\u5668\u6784\u5efa\u6587\u4ef6\nBootstrap: docker #\u9009\u62e9\u6784\u5efa\u955c\u50cf\u7684\u4ee3\u7406 docker library shub\nFrom: tensorflow/tensorflow:latest-gpu #\u9009\u62e9\u8981\u6784\u5efa\u7684\u955c\u50cf\nStage: build\n\n%files #\u4ece\u4e3b\u673a\u590d\u5236\u6587\u4ef6\u5230\u5bb9\u5668\u5185\u90e8\n    /var/py/train.py /opt/train.py\n%environment #\u8bbe\u7f6e\u73af\u5883\u53d8\u91cf\n    export LISTEN_PORT=12345\n    export LC_ALL=C\n%runscript #\u5bb9\u5668\u8fd0\u884c\u65f6\u6267\u884c\n    echo "Container was created $NOW"\n    echo "Arguments received: $*"\n    exec echo "$@"\n%labels #\u8bbe\u7f6e \u955c\u50cf\u4e0a\u7684\u6807\u7b7e\n    Author jason.zhang@xtaotech.com\n    Version v0.0.1\n\n%help #\u8bbe\u7f6e\u5e2e\u52a9\u6587\u6863\n    This is a demo container used to illustrate a def file that uses all\n    supported sections.\n    \n'})}),"\n",(0,r.jsx)(e.p,{children:"\u6784\u5efabuild"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"singularity build jason-tf.sif jason_tf.def\n"})}),"\n",(0,r.jsx)(e.h3,{id:"\u56dbsingularity-\u5e38\u7528\u547d\u4ee4",children:"\u56db\u3001singularity \u5e38\u7528\u547d\u4ee4"}),"\n",(0,r.jsx)(e.p,{children:"1\u3001\u8fd0\u884c singularity"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"singularity shell molspin.sif #\u4ea4\u4e92\u5f0f\u6267\u884c\nsingularity exec molspin.sif which mpirun #\u540e\u53f0\u6267\u884csingularity\u73af\u5883\u91cc\u7684\u5e94\u7528\u547d\u4ee4\n"})}),"\n",(0,r.jsx)(e.p,{children:"\u5176\u4ed6\u547d\u4ee4"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"singularity inspect molspin.sif #\u67e5\u770b\u6807\u7b7e\nsingularity run-help molspin.sif #\u67e5\u770b\u5e2e\u52a9\u6587\u6863\n"})}),"\n",(0,r.jsx)(e.h3,{id:"\u4e94\u642d\u5efa\u8f6f\u4ef6\u73af\u5883",children:"\u4e94\u3001\u642d\u5efa\u8f6f\u4ef6\u73af\u5883"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"singularity shell -w molspin #\u8fdb\u5165\u540d\u4e3a molspin\u7684\u955c\u50cf\uff0c-w \u53ef\u5199\u6a21\u5f0f\nsingularity shell molspin.sif #\u8fdb\u5165\u53ea\u8bfb\u6a21\u5f0f\u955c\u50cf\n"})}),"\n",(0,r.jsx)(e.h3,{id:"\u516d\u96c6\u7fa4\u4f7f\u7528singularity",children:"\u516d\u3001\u96c6\u7fa4\u4f7f\u7528singularity"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"# \u521b\u5efasandbox\uff1b\n# \u8fd9\u91cc\u5c06\u521b\u5efa\u7684sandbox\u547d\u540d\u4e3aubuntu20_lammps,\u5e76\u4f7f\u7528docker hub\u4e0a\u73b0\u6709\u7684\u5bb9\u5668 ubuntu:20.04 \u4f5c\u4e3a\u57fa\u7840\u955c\u50cf\u3002\nsingularity build --sandbox ./ubuntu20_lammps docker://ubuntu:20.04\n\n# \u8fdb\u5165\u521b\u5efa\u597d\u7684sandbox\uff0c\u5e76\u8fdb\u884c\u4fee\u6539\uff1b\n# \u5176\u4e2d-w\u8868\u793a\u53ef\u5199\u3002\u8fdb\u5165\u540esingularity\u4f1a\u81ea\u52a8\u6302\u8f7d\u7684HOME\u76ee\u5f55\uff0c\u5982\u679c\u662f\u7528root\u7528\u6237\u8fdb\u5165\uff0c\u5219\u4f1a\u6302\u8f7d/root\u76ee\u5f55\nsingularity shell -w ./ubuntu20_lammps\n\n# Ubuntu\u4e0b\u5b89\u88c5LAMMPS\u5e76\u884c\u7248\u9700\u8981\u5b89\u88c5\u5fc5\u8981\u7684\u4f9d\u8d56\u5305\napt update && apt upgrade -y\napt install openmpi-bin openmpi-doc libopenmpi-dev -y\napt \u57df\u540d \n\n# \u5b89\u88c5fftw\nwget http://www.fftw.org/fftw-3.3.9.tar.gz\ntar zxvf fftw-3.3.9.tar.gz\ncd fftw-3.3.9\n./configure --prefix=/opt/software/fftw_3.3.9 --enable-shared --enable-static --enable-fma\nmake -j && make install\n\n# \u8bbe\u7f6e\u4e34\u65f6fftw\u73af\u5883\u53d8\u91cf\nexport PATH=/opt/software/fftw_3.3.9/bin:$PATH\nexport LD_LIBRARY_PATH=/opt/software/fftw_3.3.9/lib:$LD_LIBRARY_PATH\n\n# \u5b89\u88c5lammps\nwget https://lammps.sandia.gov/tars/lammps-10Feb21.tar.gz\ntar zxvf lammps-10Feb21.tar.gz\ncd lammps-10Feb21\ncd src\nvim MAKE/OPTIONS/Makefile.g++_openmpi # \u4fee\u6539\u5982\u4e0b\u884c\n  FFT_INC = -DFFT_FFTW -I/opt/software/fftw_3.3.9/include\n  FFT_PATH = -L/opt/software/fftw_3.3.9/lib\n  FFT_LIB = -lfftw3\n\nmake yes-std\nmake no-lib\nmake -j g++_openmpi\n\nmkdir /opt/software/lammps\ncp ./lmp_g++_openmpi /opt/software/lammps/\n\n# \u8bbe\u7f6e\u4e34\u65f6lammps\u73af\u5883\u53d8\u91cf\nexport PATH=/opt/software/lammps:$PATH\n\n# \u9a8c\u8bc1(\u5bb9\u5668\u5185)\ncd /root\ncp /opt/lammps-10Feb21/bench/in.lj .\nmpirun --allow-run-as-root -np 2 --mca btl ^openib lmp_g++_openmpi -in in.lj\n\n\n# \u9000\u51fa\u5bb9\u5668\uff0c\u8bbe\u7f6e\u6c38\u4e45\u73af\u5883\u53d8\u91cf(\u5bbf\u4e3b\u673a)\nvim ./ubuntu20_lammps/environment\n# \u52a0\u5165\u4e0b\u9762\u4e24\u884c\nexport PATH=/opt/software/fftw_3.3.9/bin:/opt/software/lammps:$PATH\nexport LD_LIBRARY_PATH=/opt/software/fftw_3.3.9/lib:$LD_LIBRARY_PATH\n\n# \u9a8c\u8bc1(\u5bbf\u4e3b\u673a)\nsingularity exec ./ubuntu20_lammps mpirun --allow-run-as-root -np 2 --mca btl ^openib lmp_g++_openmpi -in in.lj\n\n# \u628a\u4fee\u6539\u597d\u7684sandbox\u6253\u5305\u6210sif\u683c\u5f0f\uff1b\n# \u5220\u9664\u4e0d\u5fc5\u8981\u7684\u5b89\u88c5\u5305, \u5982 fftw-3.3.9.tar.gz lammps-10Feb21.tar.gz\n# \u4f7f\u7528\u524d\u9762\u521b\u5efa\u7684sandbox\u76ee\u5f55\u751f\u6210singularity image file\u683c\u5f0f\u955c\u50cf\u3002\nsingularity build ubuntu20_lammps.sif ./ubuntu20_lammps\n\n\u4e0a\u4f20ubuntu20_lammps.sif \u5230\u96c6\u7fa4\u73af\u5883\u4e2d\u3002\n\n\u4f7f\u7528\u63d0\u4ea4\u811a\u672c\u8fdb\u884c\u63d0\u4ea4\u4f5c\u4e1a\u3002\n"})}),"\n",(0,r.jsx)(e.h1,{id:"\u4e03\u5220\u9664\u6784\u5efa\u7684\u5bb9\u5668",children:"\u4e03\u3001\u5220\u9664\u6784\u5efa\u7684\u5bb9\u5668"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-shell",children:"# \u5047\u8bbe\u8981\u5220\u9664\u7684\u4e3a\u6587\u4ef6\u5939\u540d\u4e3amolspin\u7684sandbox\u955c\u50cf\n\n# \u9996\u5148\uff0c\u4ee5\u53ef\u8bfb\u7684\u6a21\u5f0f\u8fdb\u5165\u8981\u5220\u9664\u7684\u955c\u50cf\nsingularity shell --fakeroot -w molspin\n\n# \u5220\u9664\u6389\u5bb9\u5668\u4e2d\uff0c\u57fa\u4e8efakeroot\u521b\u5efa\u7684\u6240\u6709\u6587\u4ef6\nrm -rf /* 1>/dev/null 2>&1\n\n# \u9000\u51fa\u955c\u50cf\nexit\n\n# \u5c06\u521b\u5efa\u597d\u7684\u8f6f\u4ef6\u955c\u50cf\u4e0a\u4f20\u5230\u9ad8\u6027\u80fd\u8ba1\u7b97\u96c6\u7fa4\uff0c\u52a0\u8f7dsingularity\u8f6f\u4ef6\u73af\u5883\n# \u5220\u9664\u6389\u5269\u4e0b\u7684\nrm -rf molspin\n\n"})})]})}function d(n={}){const{wrapper:e}={...(0,s.R)(),...n.components};return e?(0,r.jsx)(e,{...n,children:(0,r.jsx)(c,{...n})}):c(n)}}}]);