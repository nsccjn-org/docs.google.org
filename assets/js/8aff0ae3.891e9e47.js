"use strict";(self.webpackChunkawesometic_docs=self.webpackChunkawesometic_docs||[]).push([[695],{28453:(e,n,o)=>{o.d(n,{R:()=>i,x:()=>r});var t=o(96540);const s={},a=t.createContext(s);function i(e){const n=t.useContext(a);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),t.createElement(a.Provider,{value:n},e.children)}},93244:(e,n,o)=>{o.r(n),o.d(n,{assets:()=>l,contentTitle:()=>r,default:()=>d,frontMatter:()=>i,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"software/3.5_env/google","title":"Google Authenticator","description":"Google\u8eab\u4efd\u9a8c\u8bc1\u5668\u662f\u4e00\u6b3eTOTP\u4e0eHOTP\u7684\u4e24\u6b65\u9a8c\u8bc1\u8f6f\u4ef6\u4ee4\u724c\uff0c\u6b64\u8f6f\u4ef6\u7528\u4e8eGoogle\u7684\u8ba4\u8bc1\u670d\u52a1\u3002\u6b64\u9879\u670d\u52a1\u6240\u4f7f\u7528\u7684\u7b97\u6cd5\u5df2\u5217\u4e8e RFC 6238 \u548c RFC 4226 \u4e2d\u3002","source":"@site/hpc/3_software/3.5_env/google.md","sourceDirName":"3_software/3.5_env","slug":"/software/3.5_env/google","permalink":"/hpc/software/3.5_env/google","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2},"sidebar":"hpc","previous":{"title":"conda and pip","permalink":"/hpc/software/3.5_env/conda"},"next":{"title":"HPCX","permalink":"/hpc/software/3.5_env/hpcx"}}');var s=o(74848),a=o(28453);const i={sidebar_position:2},r="Google Authenticator",l={},c=[{value:"Google\u8eab\u4efd\u9a8c\u8bc1\u5668\u662f\u4e00\u6b3eTOTP\u4e0eHOTP\u7684\u4e24\u6b65\u9a8c\u8bc1\u8f6f\u4ef6\u4ee4\u724c\uff0c\u6b64\u8f6f\u4ef6\u7528\u4e8eGoogle\u7684\u8ba4\u8bc1\u670d\u52a1\u3002\u6b64\u9879\u670d\u52a1\u6240\u4f7f\u7528\u7684\u7b97\u6cd5\u5df2\u5217\u4e8e RFC 6238 \u548c RFC 4226 \u4e2d\u3002",id:"google\u8eab\u4efd\u9a8c\u8bc1\u5668\u662f\u4e00\u6b3etotp\u4e0ehotp\u7684\u4e24\u6b65\u9a8c\u8bc1\u8f6f\u4ef6\u4ee4\u724c\u6b64\u8f6f\u4ef6\u7528\u4e8egoogle\u7684\u8ba4\u8bc1\u670d\u52a1\u6b64\u9879\u670d\u52a1\u6240\u4f7f\u7528\u7684\u7b97\u6cd5\u5df2\u5217\u4e8e-rfc-6238-\u548c-rfc-4226-\u4e2d",level:6},{value:"Google\u8eab\u4efd\u9a8c\u8bc1\u5668\u7ed9\u4e88\u7528\u6237\u4e00\u4e2a\u516d\u4f4d\u5230\u516b\u4f4d\u7684\u4e00\u6b21\u6027\u5bc6\u7801\u7528\u4e8e\u8fdb\u884c\u767b\u5f55Google\u6216\u5176\u4ed6\u7ad9\u70b9\u65f6\u7684\u9644\u52a0\u9a8c\u8bc1\u3002\u5176\u540c\u6837\u53ef\u4ee5\u7ed9\u7b2c\u4e09\u65b9\u5e94\u7528\u751f\u6210\u53e3\u4ee4\uff0c\u4f8b\u5982\u5bc6\u7801\u7ba1\u7406\u5458\u6216\u7f51\u7edc\u786c\u76d8\u3002",id:"google\u8eab\u4efd\u9a8c\u8bc1\u5668\u7ed9\u4e88\u7528\u6237\u4e00\u4e2a\u516d\u4f4d\u5230\u516b\u4f4d\u7684\u4e00\u6b21\u6027\u5bc6\u7801\u7528\u4e8e\u8fdb\u884c\u767b\u5f55google\u6216\u5176\u4ed6\u7ad9\u70b9\u65f6\u7684\u9644\u52a0\u9a8c\u8bc1\u5176\u540c\u6837\u53ef\u4ee5\u7ed9\u7b2c\u4e09\u65b9\u5e94\u7528\u751f\u6210\u53e3\u4ee4\u4f8b\u5982\u5bc6\u7801\u7ba1\u7406\u5458\u6216\u7f51\u7edc\u786c\u76d8",level:6},{value:"\u4e00\u3001\u5b89\u88c5\u4f7f\u7528",id:"\u4e00\u5b89\u88c5\u4f7f\u7528",level:4}];function h(e){const n={code:"code",h1:"h1",h4:"h4",h6:"h6",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"google-authenticator",children:"Google Authenticator"})}),"\n",(0,s.jsx)(n.h6,{id:"google\u8eab\u4efd\u9a8c\u8bc1\u5668\u662f\u4e00\u6b3etotp\u4e0ehotp\u7684\u4e24\u6b65\u9a8c\u8bc1\u8f6f\u4ef6\u4ee4\u724c\u6b64\u8f6f\u4ef6\u7528\u4e8egoogle\u7684\u8ba4\u8bc1\u670d\u52a1\u6b64\u9879\u670d\u52a1\u6240\u4f7f\u7528\u7684\u7b97\u6cd5\u5df2\u5217\u4e8e-rfc-6238-\u548c-rfc-4226-\u4e2d",children:"Google\u8eab\u4efd\u9a8c\u8bc1\u5668\u662f\u4e00\u6b3eTOTP\u4e0eHOTP\u7684\u4e24\u6b65\u9a8c\u8bc1\u8f6f\u4ef6\u4ee4\u724c\uff0c\u6b64\u8f6f\u4ef6\u7528\u4e8eGoogle\u7684\u8ba4\u8bc1\u670d\u52a1\u3002\u6b64\u9879\u670d\u52a1\u6240\u4f7f\u7528\u7684\u7b97\u6cd5\u5df2\u5217\u4e8e RFC 6238 \u548c RFC 4226 \u4e2d\u3002"}),"\n",(0,s.jsx)(n.h6,{id:"google\u8eab\u4efd\u9a8c\u8bc1\u5668\u7ed9\u4e88\u7528\u6237\u4e00\u4e2a\u516d\u4f4d\u5230\u516b\u4f4d\u7684\u4e00\u6b21\u6027\u5bc6\u7801\u7528\u4e8e\u8fdb\u884c\u767b\u5f55google\u6216\u5176\u4ed6\u7ad9\u70b9\u65f6\u7684\u9644\u52a0\u9a8c\u8bc1\u5176\u540c\u6837\u53ef\u4ee5\u7ed9\u7b2c\u4e09\u65b9\u5e94\u7528\u751f\u6210\u53e3\u4ee4\u4f8b\u5982\u5bc6\u7801\u7ba1\u7406\u5458\u6216\u7f51\u7edc\u786c\u76d8",children:"Google\u8eab\u4efd\u9a8c\u8bc1\u5668\u7ed9\u4e88\u7528\u6237\u4e00\u4e2a\u516d\u4f4d\u5230\u516b\u4f4d\u7684\u4e00\u6b21\u6027\u5bc6\u7801\u7528\u4e8e\u8fdb\u884c\u767b\u5f55Google\u6216\u5176\u4ed6\u7ad9\u70b9\u65f6\u7684\u9644\u52a0\u9a8c\u8bc1\u3002\u5176\u540c\u6837\u53ef\u4ee5\u7ed9\u7b2c\u4e09\u65b9\u5e94\u7528\u751f\u6210\u53e3\u4ee4\uff0c\u4f8b\u5982\u5bc6\u7801\u7ba1\u7406\u5458\u6216\u7f51\u7edc\u786c\u76d8\u3002"}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h4,{id:"\u4e00\u5b89\u88c5\u4f7f\u7528",children:"\u4e00\u3001\u5b89\u88c5\u4f7f\u7528"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"\u8f6f\u4ef6\u5b89\u88c5"}),"\n",(0,s.jsx)(n.p,{children:"a. \u4e8c\u8fdb\u5236\u5b89\u88c5"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"yum install -y epel-* mercurial autoconf automake libtool pam-devel\n\nyum install -y google-authenticator\n"})}),"\n",(0,s.jsx)(n.p,{children:"b. \u7f16\u8bd1\u5b89\u88c5"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"yum install -y epel-* mercurial autoconf automake libtool pam-devel git \n\ngit clone https://github.com/google/google-authenticator-libpam.git\n\ncd google-authenticator-libpam-master/  #\u8fdb\u5165\u76ee\u5f55\nchmod +x bootstrap.sh  #\u8bbe\u7f6e\u53ef\u6267\u884c\u6743\u9650\n./bootstrap.sh  \n./configure\nmake install \nln -s /usr/local/lib/security/pam_google_authenticator.so /usr/lib64/security/pam_google_authenticator.so\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"PAM\u914d\u7f6e"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'vim /etc/pam.d/sshd\nauth required pam_google_authenticator.so\n# \u6216\u8005\necho   "auth       required     pam_google_authenticator.so" >>/etc/pam.d/sshd\n'})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"SSH\u914d\u7f6e"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"vim /etc/ssh/sshd_config\n# \u5c06\nChallengeResponseAuthentication no\n# \u6539\u4e3a\nChallengeResponseAuthentication yes\n# \u6216\u8005\nsed -i 's/ChallengeResponseAuthentication no/ChallengeResponseAuthentication yes/g' /etc/ssh/sshd_config\n# \u91cd\u542fsshd\u670d\u52a1\nsystemctl restart sshd.service\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"google-authenticator\u8fd0\u884c\u914d\u7f6e"}),"\n",(0,s.jsx)(n.p,{children:"\u603b\u7684\u6765\u8bf4\uff0c\u9996\u5148\u8fd0\u884cgoogle-authenticator\u4e8c\u8fdb\u5236\u7a0b\u5e8f\uff0c\u7136\u540e\u4e00\u8defy\u4e0b\u6765\u5373\u53ef\uff0c\u4e2d\u95f4\u4f7f\u7528\u4e8c\u7ef4\u7801\uff0c\u6216\u8005\u5bc6\u94a5\u4e0e\u624b\u673a\u7aef\u8fdb\u884c\u7ed1\u5b9a\uff0c\u4e0b\u65b9\u662f\u5177\u4f53\u8fc7\u7a0b\u3002"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'google-authenticator\nDo you want authentication tokens to be time-based (y/n) y\nWarning: pasting the following URL into your browser exposes the OTP secret to Google:\nhttps://www.google.com/chart?chs=200x200&chld=M|0&cht=qr&chl=otpauth://totp/root@demo%3Fsecret%3DXQ2WB526GLPJ7SI64Z3RZISOEE%26issuer%3Ddemo\n                                                        \n                                                                                \n                                                                                \n                                                                                \n            \u8fd9\u91cc\u4f1a\u6709\u4e00\u4e2a\u4e8c\u7ef4\u7801\uff0c\u9700\u8981\u5728\u624b\u673a\u4e0a\u4e0b\u8f7d`googleauthenticator`APP\u626b\u7801\u7ed1\u5b9a\n            \u5b89\u5353 IOS\u624b\u673a\u90fd\u53ef\u4ee5\u5728\u5e94\u7528\u5546\u5e97\u641c\u7d22\u5b89\u88c5\n                                                                                \n                                                                                \n                                                                                                                                                                    \nYour new secret key is: XQ2WB526GLPJ7SI64Z3RZISOEE\nYour verification code is 917990\nYour emergency scratch codes are:\n42623319\n72314571\n14476695\n95764389\n38976136\n\nDo you want me to update your "/root/.google_authenticator" file? (y/n) y\n\nDo you want to disallow multiple uses of the same authentication\ntoken? This restricts you to one login about every 30s, but it increases\nyour chances to notice or even prevent man-in-the-middle attacks (y/n) y\n\nBy default, a new token is generated every 30 seconds by the mobile app.\nIn order to compensate for possible time-skew between the client and the server,\nwe allow an extra token before and after the current time. This allows for a\ntime skew of up to 30 seconds between authentication server and client. If you\nexperience problems with poor time synchronization, you can increase the window\nfrom its default size of 3 permitted codes (one previous code, the current\ncode, the next code) to 17 permitted codes (the 8 previous codes, the current\ncode, and the 8 next codes). This will permit for a time skew of up to 4 minutes\nbetween client and server.\nDo you want to do so? (y/n) y\n\nIf the computer that you are logging into isn\'t hardened against brute-force\nlogin attempts, you can enable rate-limiting for the authentication module.\nBy default, this limits attackers to no more than 3 login attempts every 30s.\nDo you want to enable rate-limiting? (y/n) y\n'})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"\u767b\u5f55"}),"\n",(0,s.jsx)(n.p,{children:"a. xshell"}),"\n"]}),"\n"]})]})}function d(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(h,{...e})}):h(e)}}}]);